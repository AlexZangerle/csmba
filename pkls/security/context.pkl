import "https://raw.githubusercontent.com/AlexZangerle/csmba/main/pkls/variables.pkl" as Vars
import "https://raw.githubusercontent.com/CollaborativeStateMachines/Cirrina/refs/heads/develop/src/main/resources/pkl/csm/Csml.pkl"
// This module contains all contexts for the accessControlSM and securityManagerSM

// securityManagerContext contains a count of failed attempts, a timestamp of the last failed attempt and the details for the alert
securityManagerContext = new Csml.ContextDescription {
  variables {
    new { name = Vars.vFailedAttemptsCount; value = "'0'" }
    new { name = Vars.vLastFailedAttemptTime; value = "'0'" }
    new { name = Vars.vAlertDetails; value = "''" }
  }
}

// accessControlContext contains door and zone id, a flag to signify if its part of an evacuationroute, user details, etc.
accessControlContext = new Csml.ContextDescription {
  variables {
    new { name = Vars.vDoorId; value = "'testDoor'" }
    new { name = Vars.vZoneId; value = "'testZone'" }
    new { name = Vars.vIsEvacuationRoute; value = "false" }
    new { name = Vars.vUserId; value = "''" }
    new { name = Vars.vUserRole; value = "''" }
    new { name = Vars.vAuthenticationStatus; value = "''" }
    new { name = Vars.vCurrentScheduleMode; value = "'unknown'" }
    new { name = Vars.vAccessDecision; value = "''" }
  }
}
